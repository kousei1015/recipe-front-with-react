## recipe-front-with-TanstackRouter

このレポジトリは以前作ったレシピアプリのフロントの部分をReactjsとTanstack Routerの組み合わせで開発し直したものになります。フロントエンドの部分は以前はNextjsを使いSSRを採用していたのですが、結局Nextjsを使わず、ReactとTanstack Routerの組み合わせでSPAを構築することにしました。詳しくいうと、元々はpagesディレクトリを採用したNextjs(SSR)とapiディレクトリを採用したディレクトリを採用したNextjs(SSR)で開発しており、どちらが望ましいか悩んでいました。最初になぜNextjsの方を採用しようとしていたのかと言えば、手軽にSSRが採用できますし、画像最適化を行うImageコンポーネントなどが魅力的に感じていたためです。ですが、実際にNextjsで開発してみると自分が開発しているアプリにNextjsは要らないのではないと思うようになりました。以下がその理由です。

1. Nextjsを採用してSSR化することで多くの場合、初期表示速度は速くなるが、私が開発するアプリにはそもそも、それほど重いデータを返すわけではない。
2. 画像最適化を行ってくれるImageコンポーネントに関しては、最初は魅力的に感じていたが、そもそも画像とともにデータをPOSTする前に、画像を最適化したり(browser-image-compressionといったライブラリを使用するなどして)、あるいはサーバー側(Ruby on Railsのライブラリを使用して)で最適化すればいい。

1. の点に関しては、そもそも私が開発するレシピアプリには、将来的にはページネーションや無限ローディングを採用して、初期に表示するデータを制限するつもりです。
追記: 最終的に、ページネーションを採用しました
2. の点に関しては、上記に書いた通り、Imageコンポーネントを使わずとも画像を最適化する方法はあるので、Nextjsを採用する決め手にならないと考えるようになりました。

上記のように、初期に表示しなければならないデータを絞り、画像も最適化するつもりです。そこからさらにNextjsを採用しSSR化して、一体何ms早くなるでしょうか。恐らく、ほとんど変わらないでしょう。要するに、パフォーマンスの観点からは、私がこれから開発するアプリにはNextjsはオーバースペックだと感じたわけです。


※ 一応書かせていただきますが、Nextjsを批判する意図は全くありません。実際にはNextjsを採用し、SSR化することでパフォーマンスの利点以外にも、SPAと比較してSEO的に有利になるので、SEOを重視するアプリにはSSRやSSGが容易に選択、利用できるNextjsにした方が良いとは思います。あくまで、私がこれから開発するアプリにはオーバースペックだろうと思っただけです。


また、今回は初めてTanstack Routerを採用することにしました。以下の2つの点が理由です。

1. 型安全
2. File-Basedのルーティングが可能

ちなみに、ドキュメントからtanstack-routerには組み込みのミューテーションAPIがないとのことなので、loader関数は使用せず、バックエンドとの通信に関しては、tanstack-queryの方で行っています。

